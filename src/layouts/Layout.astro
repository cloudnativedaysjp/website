---
import Navbar from '../components/Navbar.astro'
import Footer from '../components/Footer.astro'
import { PUBLIC_SITE_TITLE } from '../server-constants'
export interface Props {
  title: string
  description: string
  url?: URL | undefined
  ogImage: string
  isTopPage?: boolean
}

const { title, description, url, ogImage, isTopPage = false } = Astro.props
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="robots" content="max-image-preview:large" />
    <meta name="description" content={description} />
    <meta property="og:url" content={url} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:site_name" content={PUBLIC_SITE_TITLE} />
    <meta property="og:image" content={ogImage} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content={ogImage} />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <link
      href="https://unpkg.com/video.js/dist/video-js.css"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/video.js/dist/video.js"></script>
    <title>{title}</title>
  </head>
  <script
    type="text/partytown"
    src="https://www.googletagmanager.com/gtag/js?id=G-XDSEZ66VFX"
  ></script>
  <script type="text/partytown">
    window.dataLayer = window.dataLayer || []
    function gtag() {
      dataLayer.push(arguments)
    }
    gtag('js', new Date())
    gtag('config', 'G-XDSEZ66VFX')
  </script>
  <script define:vars={{ isTopPage }}>
    if (isTopPage) {
      const navbarWrapper = document.getElementById('navbar-wrapper');
      window.addEventListener('scroll', () => {
        if (window.scrollY > 100) {
          navbarWrapper?.classList.remove('opacity-0', 'pointer-events-none');
        } else {
          navbarWrapper?.classList.add('opacity-0', 'pointer-events-none');
        }
      });
    }
  </script>
  <body>
    <div id="navbar-wrapper" class={`fixed top-0 w-full z-50 transition-opacity duration-300 ${isTopPage ? 'opacity-0 pointer-events-none' : ''}`}>
      <Navbar
        links={[
          {
            href: '/posts',
            text: 'Blog',
          },
          {
            href: 'https://twitter.com/cloudnativedays',
            icon: 'tabler:brand-twitter',
          },
        ]}
      />
    </div>
    <slot />

    <hr class="border-gray-300" />

    <slot name="footer">
      <Footer />
    </slot>
  </body>
</html>

<style is:global>
  :root {
    --accent: 124, 58, 237;
    --accent-gradient: linear-gradient(
      45deg,
      rgb(var(--accent)),
      #da62c4 30%,
      white 60%
    );
  }
  html {
    font-family: system-ui, sans-serif;
  }
  code {
    font-family: Menlo, Monaco, Lucida Console, Liberation Mono,
      DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace;
  }
</style>

<div class="fixed inset-0 z-[-1]">
  <div class="absolute inset-0 bg-white"></div>
  <img
    src="/images/background.jpg"
    alt="Background"
    class="absolute inset-0 w-full h-full object-cover opacity-30"
  />
</div>
