---
import Hero from '../components/Hero.astro'
import Talk from '../components/Talk.astro'
import { Conferences } from '../data/data'
import { talkMap } from '../data/data'
import Layout from '../layouts/Layout.astro'
export async function getStaticPaths() {
  return Conferences.flatMap((conference) => {
    return { params: { abbr: conference.abbr } }
  })
}
const { abbr } = Astro.params
const conference = Conferences.find((conference) => conference.abbr == abbr)
const conferenceExists = conference != undefined
const talks = talkMap.get(abbr || '')

const title = conference?.name || '';
const description = conference?.theme || '';
const url = Astro.url;
const ogImage = conference?.image || '/favicon.svg';
---

<Layout title={title} description={description} url={url} ogImage={ogImage}>
  <main>
    {
      conferenceExists && (
        <>
          <Hero title={conference.name} href={'/' + abbr} logo={conference.image}>
            <p class="text-2xl text-black font-serif mb-6">{conference.theme}</p>
            <p class="mt-4 text-lg text-black whitespace-pre-line">
              {conference.conferenceDays
                .filter((day) => !day.internal)
                .map((day) => day.date)
                .join(', ')}
            </p>
          </Hero>
          <section class="pb-20">
            <div class="container mx-auto px-4 pt-8">
              <h2 class="relative px-4 text-4xl font-bold text-center">
                Sessions
              </h2>

              <div
                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 pt-8"
                style={{ autoRows: 'minmax(0, auto)' }}
              >
                {talks ? (
                  talks?.map((talk) => {
                    const url = `/${abbr}/talks/${talk.id}`
                    return (
                      <div class="bg-white/60 backdrop-blur-sm rounded-xl overflow-hidden hover:bg-white/80 transition-all duration-300">
                        <div class="p-4">
                          <Talk
                            id={talk.id}
                            abbr={abbr}
                            title={talk.title}
                            speakers={talk.speakers}
                          />
                        </div>
                      </div>
                    )
                  })
                ) : (
                  <div class="pt-12 pt-12 pt-3 w-full px-4 text-center">
                    <div class="relative flex flex-col min-w-0 break-words bg-white w-full mb-8 shadow-lg rounded-lg">
                      <div class="px-4 py-5 flex-auto">
                        <h6 class="text-xl font-semibold">近日公開！</h6>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            </div>
          </section>
        </>
      )
    }
  </main>
</Layout>

<style>
</style>
