---
import BlogPostsLink from '../components/BlogPostsLink.astro'
import Event from '../components/Event.astro'
import Hero from '../components/Hero.astro'
import PostDate from '../components/PostDate.astro'
import PostExcerpt from '../components/PostExcerpt.astro'
import PostFeaturedImage from '../components/PostFeaturedImage.astro'
import PostTitle from '../components/PostTitle.astro'
import { Conferences } from '../data/data'
import Layout from '../layouts/Layout.astro'
import { getPostLink } from '../lib/blog-helpers'
import { getPosts } from '../lib/notion/client'
import type { Conference } from '../types/conference'

// æœ€æ–°ã®3ä»¶ã®ãƒ–ãƒ­ã‚°è¨˜äº‹ã‚’å–å¾—
const latestPosts = await getPosts(3)
---

<Layout title="CloudNative Days" description="CloudNative Days ã¯ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã€ä¼æ¥­ã€æŠ€è¡“è€…ãŒä¸€å ‚ã«ä¼šã—ã€ã‚¯ãƒ©ã‚¦ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ ãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆã‚’ç‰½å¼•ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ãŸãƒ†ãƒƒã‚¯ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã§ã™ã€‚" ogImage="/favicon.svg">
  <main>
    <Hero title="CloudNative Days">
      <p class="mt-4 text-lg text-gray-300">
        CloudNative Days ã¯ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã€ä¼æ¥­ã€æŠ€è¡“è€…ãŒä¸€å ‚ã«ä¼šã—ã€ã‚¯ãƒ©ã‚¦ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ ãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆã‚’ç‰½å¼•ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ãŸãƒ†ãƒƒã‚¯ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã§ã™ã€‚
      </p>
      <p class="mt-4 text-lg text-gray-300">
        æœ€æ–°ã®æ´»ç”¨äº‹ä¾‹ã‚„å…ˆé€²çš„ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’å­¦ã¹ã‚‹ã®ã¯ã‚‚ã¡ã‚ã‚“ã€ãƒŠãƒ¬ãƒƒã‚¸ã®å…±æœ‰ã‚„ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã®å ´ã‚’é€šã˜ã¦ç™»å£‡è€…ã¨å‚åŠ è€…ã€å‚åŠ è€…åŒå£«ã®ç¹‹ãŒã‚Šã‚’æ·±ã‚ã€åˆå¿ƒè€…ã‹ã‚‰ç†Ÿç·´è€…ã¾ã§ãŒå…±ã«æˆé•·ã§ãã‚‹æ©Ÿä¼šã‚’æä¾›ã—ã¾ã™ã€‚
      </p>
      <p class="mt-4 text-lg text-gray-300">
        çš†æ§˜ãŒã‚¯ãƒ©ã‚¦ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–æŠ€è¡“ã‚’é©åˆ‡ã«é¸æŠã—ã€æ´»ç”¨ã—ã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«é€²ã‚€æ‰‹åŠ©ã‘ã«ãªã‚‹ã“ã¨ã‚’é¡˜ã£ã¦ã„ã¾ã™ã€‚
      </p>
      <p class="mt-4 text-lg text-gray-300">
        ã‚¯ãƒ©ã‚¦ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–ã§ã€æœªæ¥ã‚’å…±ã«å‰µé€ ã—ã¾ã—ã‚‡ã†ã€‚
      </p>
    </Hero>
    <section class="pb-10 bg-gray-300 -mt-24">
      <div class="container mx-auto px-4">
        <h2 class="text-white relative px-4 text-4xl font-bold pb-16">
          Upcoming Event
        </h2>
        <div class="relative">
          <div class="grid grid-cols-1 gap-4">
            {
              Conferences?.filter(
                (conference) => conference.status == 'registered',
              ).map((conference) => {
                const url = `https://event.cloudnativedays.jp/${conference.abbr}`
                const eventDays = conference.conferenceDays
                  .filter((day) => !day.internal)
                  .map((day) => day.date)
                  .join(',')
                return (
                  <>
                    {/* ã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’ãƒ–ãƒ­ã‚°ã¨çµ±ä¸€ï¼†ãƒ›ãƒãƒ¼åŠ¹æœã‚’å¼·åŒ– */}
                    <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-xl hover:scale-[1.02] transition-all duration-300 card-hover">
                      <a href={url} class="block" />
                      <Event
                        url={url}
                        name={conference.name}
                        days={eventDays}
                        img={conference.image}
                      />
                    </div>
                  </>
                )
              })
            }
          </div>
        </div>
      </div>
    </section>
    
    {/* æœ€æ–°ãƒ–ãƒ­ã‚°ã‚¨ãƒ³ãƒˆãƒªãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ - ã‚«ãƒ¼ãƒ‰å½¢å¼ã«æ”¹è‰¯ */}
    <section class="pb-10 bg-gray-300">
      <div class="container mx-auto px-4">
        <h2 class="text-black relative px-4 text-4xl font-bold pb-6">
          æœ€æ–°ãƒ–ãƒ­ã‚°
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {
            latestPosts.map((post) => (
              <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-xl hover:scale-[1.02] transition-all duration-300 card-hover">
                <a href={getPostLink(post.Slug)} class="block">
                  <div class="relative h-48 overflow-hidden">
                    {post.FeaturedImage ? (
                      <PostFeaturedImage post={post} />
                    ) : (
                      <div class="bg-gradient-to-r from-blue-500 to-purple-600 h-full flex items-center justify-center">
                        <span class="text-white text-4xl">
                          {post.Icon && post.Icon.Type === 'emoji' && 'Emoji' in post.Icon 
                            ? post.Icon.Emoji 
                            : 'ğŸ“'}
                        </span>
                      </div>
                    )}
                  </div>
                  <div class="p-5">
                    <div class="text-sm text-gray-500 mb-2">
                      <PostDate post={post} />
                    </div>
                    <h3 class="text-xl font-semibold mb-3 text-gray-800 line-clamp-2">
                      {post.Title}
                    </h3>
                    <div class="text-gray-600 line-clamp-3">
                      <PostExcerpt post={post} />
                    </div>
                  </div>
                </a>
              </div>
            ))
          }
        </div>
        <div class="mt-8 text-center">
          <a href="/posts" class="inline-block px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 hover:scale-105 transition-all duration-300">
            ãƒ–ãƒ­ã‚°è¨˜äº‹ä¸€è¦§ã‚’è¦‹ã‚‹
          </a>
        </div>
      </div>
    </section>
    
    <section class="pb-20 bg-gray-300">
      <div class="container mx-auto px-4">
        <h2 class="text-black relative px-4 text-4xl font-bold pb-6">
          Past Events
        </h2>
        <div class="relative">
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {
              Conferences?.filter(
                (conference) => conference.status == 'archived' || conference.status == 'migrated',
              )
                .sort((first, second) => second.id - first.id)
                .map((conference) => {
                  const url = `/${conference.abbr}`
                  const eventDays = conference.conferenceDays
                    .filter((day) => !day.internal)
                    .map((day) => day.date)
                    .join(',')
                  return (
                    <>
                      {/* ã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’ãƒ–ãƒ­ã‚°ã¨çµ±ä¸€ï¼†ãƒ›ãƒãƒ¼åŠ¹æœã‚’å¼·åŒ– */}
                      <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-xl hover:scale-[1.02] transition-all duration-300 card-hover">
                        <a href={url} class="block">
                          <Event
                            url={url}
                            name={conference.name}
                            days={eventDays}
                            img={conference.image}
                          />
                        </a>
                      </div>
                    </>
                  )
                })
            }
          </div>
        </div>
      </div>
    </section>
  </main>
</Layout>

<style>
  /* line-clampãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¯ãƒ©ã‚¹ */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  /* ã‚«ã‚¹ã‚¿ãƒ ã®ãƒ›ãƒãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå¼·åŒ– */
  .card-hover {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
  }
  
  .card-hover:hover {
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
    transform: translateY(-4px);
  }
</style>
