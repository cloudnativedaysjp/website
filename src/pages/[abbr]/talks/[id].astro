---
import { talkMap } from "../../../data/talks"
import Layout from "../../../layouts/Layout.astro"

export async function getStaticPaths() {
	return [...talkMap.entries()].map((a) => {
        const abbr = a[0]
        const talks = a[1]
        return talks.map((talk) => {
            return {params: {abbr: abbr, id: talk.id}}
        })
    })
}
const { abbr, id} = Astro.params;
const talk = talkMap.get(abbr||"")?.find((talk) => {
    return talk.id == Number(id)
})
const talkExists = talk != undefined
---

<Layout title="Welcome to Astro.">
	<main>
        {talkExists &&
            <div>
                <p>{talk.title}</p>
                <p>{talk.abstract}</p>
                <p>{talk.speakers.map((speaker) => speaker.name).join(",")}</p>
                <p></p>
                <p></p>
                <p></p>
                <p></p>
                <video
                    id="my-player"
                    class="video-js video-js vjs-16-9 vjs-big-play-centered"
                    data-setup='{"fluid": true}'
                    controls
                    preload="auto"
                >
                    <source src={talk.videoId} type="application/x-mpegURL" />
                </video>
                <a href={talk.documentUrl}>発表資料</a>
            </div>
        }
	</main>
</Layout>